# Milestone v1.0: Ephraim Care NDIS Platform

**Status:** âœ… SHIPPED 2026-01-27
**Phases:** 1-13
**Total Plans:** 77

## Overview

This milestone delivered a complete NDIS management platform across 13 phases, from database foundation through scale features. The build order respected strict data dependencies: foundation infrastructure enabled all features, participant/worker entities enabled shifts, shifts enabled mobile check-in, check-in data enabled invoicing, and invoicing enabled the participant portal.

## Phases

### Phase 1: Foundation

**Goal:** The monorepo, database, auth system, and compliance infrastructure exist so that all subsequent features build on secure, auditable, timezone-correct foundations.
**Depends on:** Nothing (first phase)
**Plans:** 9 plans

Plans:
- [x] 01-PLAN-01.md -- Monorepo scaffold (Turborepo + pnpm + 3 apps)
- [x] 01-PLAN-02.md -- Shared packages (types, supabase, utils, ui, config)
- [x] 01-PLAN-03.md -- Database schema migrations (15 migration files)
- [x] 01-PLAN-04.md -- RLS policies and auth hook permissions
- [x] 01-PLAN-05.md -- Auth system (login, reset password, RBAC, session timeout)
- [x] 01-PLAN-06.md -- Seed data (5 participants, 5 workers, 20 shifts, 2 invoices)
- [x] 01-PLAN-07.md -- Dashboard shell and branding (admin + participant portals)
- [x] 01-PLAN-08.md -- Testing infrastructure (Vitest + Playwright + initial tests)
- [x] 01-PLAN-09.md -- Integration verification and checkpoint

---

### Phase 2: Participant Management

**Goal:** Admin can create, view, edit, and archive participants with full NDIS plan details.
**Depends on:** Phase 1
**Plans:** 5 plans

Plans:
- [x] 02-01-PLAN.md -- Dependencies, Zod schemas, and reusable DataTable component
- [x] 02-02-PLAN.md -- Participant list page with search, filter, and sortable table
- [x] 02-03-PLAN.md -- Multi-step create form (4 steps with validation + NDIS uniqueness)
- [x] 02-04-PLAN.md -- Participant detail page with budget progress and plan countdown
- [x] 02-05-PLAN.md -- Edit form (read-only fields) and archive dialog (type-to-confirm)

---

### Phase 3: Worker Management

**Goal:** Admin can create, view, and edit worker profiles with qualifications and compliance dates.
**Depends on:** Phase 1
**Plans:** 5 plans

Plans:
- [x] 03-01-PLAN.md -- DB migration (compliance columns), Zod schemas, constants, domain types
- [x] 03-02-PLAN.md -- Worker list page (DataTable, search, filter, compliance dot)
- [x] 03-03-PLAN.md -- Worker create form and invite API route (auth + email)
- [x] 03-04-PLAN.md -- Worker detail page (stats, compliance section, qualifications)
- [x] 03-05-PLAN.md -- Worker edit form (read-only email) and resend invite

---

### Phase 4: Shift Scheduling

**Goal:** Admin can schedule shifts with conflict detection and validation.
**Depends on:** Phase 2, Phase 3
**Plans:** 4 plans

Plans:
- [x] 04-01-PLAN.md -- DB migration (support_type column, enum values, overlap index), Zod schemas
- [x] 04-02-PLAN.md -- Sheet UI component, shift list page (cards grouped by day, week navigation)
- [x] 04-03-PLAN.md -- Create shift form (participant-first selection, conflict detection dialogs)
- [x] 04-04-PLAN.md -- Shift filters, detail sheet, inline edit, cancel with reason

---

### Phase 5: Worker Mobile App

**Goal:** Workers can view shifts, check in with GPS, and check out from a mobile app.
**Depends on:** Phase 4
**Plans:** 9 plans

Plans:
- [x] 05-01-PLAN.md -- DB migration (shift_check_ins, push tokens, geo columns) + Supabase client
- [x] 05-02-PLAN.md -- Auth system (SessionProvider, login screen, session persistence)
- [x] 05-03-PLAN.md -- Core data hooks (useShifts, shiftStore, syncStore, proximity utility)
- [x] 05-04-PLAN.md -- Home tab (today's shifts, ShiftCard, 4-tab bottom nav)
- [x] 05-05-PLAN.md -- Shift detail + GPS check-in (proximity enforcement, medical alerts)
- [x] 05-06-PLAN.md -- Live timer + check-out (AppState timer, duration calc, case note modal)
- [x] 05-07-PLAN.md -- Weekly schedule calendar + profile/logout + notes placeholder
- [x] 05-08-PLAN.md -- Admin override checkout API
- [x] 05-09-PLAN.md -- Offline caching + push notifications + sync engine

---

### Phase 6: Case Notes

**Goal:** Workers document care after each shift; admin reviews notes.
**Depends on:** Phase 5
**Plans:** 4 plans

Plans:
- [x] 06-01-PLAN.md -- DB migration (concern columns, admin comments table, RLS)
- [x] 06-02-PLAN.md -- Mobile case note creation (CaseNoteModal, useCreateCaseNote)
- [x] 06-03-PLAN.md -- Admin case notes tab (filters, review, private comments)
- [x] 06-04-PLAN.md -- Mobile My Notes tab (pending shifts list, edit within 24h)

---

### Phase 7: Invoicing

**Goal:** Generate accurate invoices from completed shifts with NDIS-compliant billing.
**Depends on:** Phase 5, Phase 6
**Plans:** 7 plans

Plans:
- [x] 07-01-PLAN.md -- DB migration (rates, holidays, counter, finalization trigger)
- [x] 07-02-PLAN.md -- Billing calculations, Zod schemas, PACE CSV export function
- [x] 07-03-PLAN.md -- Support type rates settings page + public holidays settings
- [x] 07-04-PLAN.md -- Invoice generation API route + generate form page
- [x] 07-05-PLAN.md -- Invoice list page + detail/preview page + finalize API
- [x] 07-06-PLAN.md -- PDF export (@react-pdf/renderer, branded PDF component)
- [x] 07-07-PLAN.md -- PACE CSV export API route + ExportCsvButton component

---

### Phase 8: Participant Portal

**Goal:** Participants view plan status, budget, and download invoices.
**Depends on:** Phase 7
**Plans:** 4 plans

Plans:
- [x] 08-01-PLAN.md -- Auth + layout setup (protected layout with role check, sidebar)
- [x] 08-02-PLAN.md -- Dashboard page (budget hero, plan info card, upcoming appointments)
- [x] 08-03-PLAN.md -- Invoices page (invoice list, preview modal, PDF download)
- [x] 08-04-PLAN.md -- Profile page + verification checkpoint

---

### Phase 9: Notifications

**Goal:** Email notifications for shift assignments, cancellations, and invoices.
**Depends on:** Phase 4, Phase 7
**Plans:** 3 plans

Plans:
- [x] 09-01-PLAN.md -- Notification infrastructure (send-email helper, HTML templates)
- [x] 09-02-PLAN.md -- Shift notifications (assignment email, cancellation email)
- [x] 09-03-PLAN.md -- Invoice notification (finalize route triggers participant email)

---

### Phase 10: Worker Screening

**Goal:** Block expired screening checks and warn on expiring.
**Depends on:** Phase 3, Phase 4
**Plans:** 2 plans

Plans:
- [x] 10-01-PLAN.md -- Shift form NDIS validation (blocking expired, warning expiring)
- [x] 10-02-PLAN.md -- Dashboard compliance widget (workers with expired/expiring checks)

---

### Phase 11: Compliance and Incidents

**Goal:** Incident reporting, compliance dashboard, portal extensions.
**Depends on:** Phase 4, Phase 7, Phase 10
**Plans:** 7 plans

Plans:
- [x] 11-01-PLAN.md -- Incident table, types, RLS policies
- [x] 11-02-PLAN.md -- Incident reporting form and list page
- [x] 11-03-PLAN.md -- NDIA reporting workflow (24h countdown, reference number)
- [x] 11-04-PLAN.md -- Compliance dashboard with health score
- [x] 11-05-PLAN.md -- Participant appointments view + cancellation requests
- [x] 11-06-PLAN.md -- Magic link login for participants
- [x] 11-07-PLAN.md -- Calendar view for shifts (day, week, month)

---

### Phase 12: Reporting and Export

**Goal:** Budget, revenue, worker hours, and activity reports with export.
**Depends on:** Phase 7
**Plans:** 6 plans

Plans:
- [x] 12-01-PLAN.md -- Report foundation (ReportLayout, DateRangePicker, CSV export helper)
- [x] 12-02-PLAN.md -- Budget utilization report (bar chart, alerts, CSV export)
- [x] 12-03-PLAN.md -- Revenue trends report (line chart, support type breakdown)
- [x] 12-04-PLAN.md -- Worker hours and participant activity reports
- [x] 12-05-PLAN.md -- Excel and PDF export for all reports
- [x] 12-06-PLAN.md -- Accounting exports (Xero/MYOB CSV, participant list, worker hours)

---

### Phase 13: Scale Features

**Goal:** Multi-organization support, SMS reminders, goal tracking, integrations.
**Depends on:** Phase 12
**Plans:** 12 plans

Plans:
- [x] 13-01-PLAN.md -- Multi-org schema + platform admin foundation
- [x] 13-02-PLAN.md -- Organization registration + onboarding flow
- [x] 13-03-PLAN.md -- Organization settings + API credentials
- [x] 13-04-PLAN.md -- Twilio SMS infrastructure
- [x] 13-05-PLAN.md -- Shift SMS reminders (24h + 2h before)
- [x] 13-06-PLAN.md -- Xero OAuth2 connection flow
- [x] 13-07-PLAN.md -- Xero invoice sync on finalize
- [x] 13-08-PLAN.md -- Participant goal tracking
- [x] 13-09-PLAN.md -- Mobile biometrics + PIN fallback
- [x] 13-10-PLAN.md -- Offline photo capture + sync
- [x] 13-11-PLAN.md -- Bulk shift creation with preview
- [x] 13-12-PLAN.md -- NDIA CSV auto-generate + one-click download

---

## Milestone Summary

**Key Decisions:**

- Monorepo structure (Turborepo + pnpm) for shared code across 3 apps
- Supabase for backend (auth + RLS + realtime + storage)
- Lesser-of billing rule for NDIS compliance
- Gapless invoice counter with atomic upsert
- Fire-and-forget notifications (don't block user operations)
- Multi-org foundation with platform admin override

**Issues Resolved:**

- RLS helper functions work without custom JWT hook (COALESCE fallback)
- Cookie typing for Supabase SSR v0.6.1 compatibility
- expo-sqlite for session storage (SecureStore 2048-byte limit)
- PostgREST type assertions for complex joins

**Tech Debt Identified:**

- Admin shift list doesn't show check-in status (data exists, not queried)
- Bulk shift notification API route is stubbed (single notifications work)
- Placeholder logo should be replaced with actual Ephraim Care logo

---

*For current project status, see .planning/PROJECT.md*

---

*Archived: 2026-01-27 as part of v1.0 milestone completion*
